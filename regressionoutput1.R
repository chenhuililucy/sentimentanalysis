library(readr)
#install.packages("estimatr")
#install.packages("margins")
#install.packages("car")
library(estimatr)
library(margins)
library(car)
#summary(regression1)


#install.packages("plyr")
#install.packages("ggplot2")
#install.packages("lmtest")



library(plyr)
library(ggplot2)
library(lmtest)
library(sandwich)

#install.packages("plm")

library(plm)

#install.packages("sandwich")

library(sandwich)


#In the most desired regression model, we would ideally like to fomulate as the following: 

#1. Change in ROA= beta1*book to market ratio+beta2*market cap+beta3*industry dummy+beta4*percwrds+beta5*change in ROA in the previous period
#2. Change in ROA= beta1*book to market ratio+beta2*market cap+beta3*industry dummy+beta4*posl+beta5*negl+beta6*negneg+beta7*change in ROA in the previous period

#However, market cap (MKVALT) has too many missing values and this significantly restricts the sample so I removed it. 

################################################################################################


#Preparation

#dat <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roa))),]



`vectorfinal(7)`<-`vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roa))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.1))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.1.1))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.1.1))),]
#`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$csho))),]

#dat1 <- transform( `vectorfinal(7)`[grep("^\\d+$",  `vectorfinal(7)`$roa),,drop=T], roa= as.numeric(as.character(roa)))
#dat1 <- transform( `vectorfinal(7)`[grep("^\\d+$",  `vectorfinal(7)`$roat.1),,drop=T], roat.1= as.numeric(as.character(roat.1)))
#dat1 <- transform( `vectorfinal(7)`[grep("^\\d+$",  `vectorfinal(7)`$roat.1.1),,drop=T], roat.1.1= as.numeric(as.character(roat.1.1)))

#`vectorfinal(7)`$BOV=as.double(`vectorfinal(7)`$prcc)*as.double(`vectorfinal(7)`$csho) / as.double(`vectorfinal(7)`$ceq)
`vectorfinal(7)`$gic=as.character(`vectorfinal(7)`$gic)
`vectorfinal(7)`$year=as.character(`vectorfinal(7)`$year)

`vectorfinal(7)`$roac=as.numeric(`vectorfinal(7)`$roa)-as.numeric(`vectorfinal(7)`$roat.1)
`vectorfinal(7)`$roac1=as.numeric(`vectorfinal(7)`$roat.1.1)-as.numeric(`vectorfinal(7)`$roa)

#results <- fastDummies::dummy_cols(fastDummies_example, select_columns = "cik")

################################################################################################


# First, akin to LM, our data indeed suggests that a high positive:negative performance words percentage in disclosure is correlated with higher future performance (significant at 5 percent level)
# Using the ratio of positive to negative performance (percwrds)  


reg = lm_robust(as.double(roac) ~ as.double(percwrds)+log(as.double(BOV))+gic+year, data = subset(`vectorfinal(7)`))
summary(reg)

#changes: adjusted period change date, removed log length 

"""

Call:
lm_robust(formula = as.double(roac) ~ as.double(percwrds) + log(as.double(BOV)) + 
gic + year, data = subset(`vectorfinal(7)`))

Standard error type:  HC2 

Coefficients:
Estimate Std. Error t value  Pr(>|t|)   CI Lower   CI Upper    DF
(Intercept)          4.067e+03  4.165e+03  0.9764 3.289e-01 -4.097e+03  1.223e+04 46173
as.double(percwrds)  3.505e-02  1.607e-02  2.1810 2.919e-02  3.551e-03  6.654e-02 46173
log(as.double(BOV)) -3.234e+01  4.094e+01 -0.7900 4.296e-01 -1.126e+02  4.790e+01 46173
gic101010           -3.474e+03  4.145e+03 -0.8380 4.020e-01 -1.160e+04  4.651e+03 46173
gic101020           -3.359e+03  4.118e+03 -0.8156 4.147e-01 -1.143e+04  4.713e+03 46173
gic151010           -3.465e+03  4.138e+03 -0.8374 4.024e-01 -1.158e+04  4.646e+03 46173
gic151020           -2.524e+03  4.387e+03 -0.5753 5.651e-01 -1.112e+04  6.074e+03 46173
gic151030           -3.221e+03  4.199e+03 -0.7671 4.431e-01 -1.145e+04  5.009e+03 46173
gic151040           -3.556e+03  4.154e+03 -0.8561 3.919e-01 -1.170e+04  4.585e+03 46173
gic151050           -2.799e+03  4.265e+03 -0.6562 5.117e-01 -1.116e+04  5.561e+03 46173
gic201010           -3.919e+03  4.165e+03 -0.9411 3.467e-01 -1.208e+04  4.243e+03 46173
gic201020           -2.728e+03  4.183e+03 -0.6522 5.143e-01 -1.093e+04  5.470e+03 46173
gic201030           -3.044e+03  4.185e+03 -0.7274 4.670e-01 -1.125e+04  5.158e+03 46173
gic201040           -3.317e+03  4.155e+03 -0.7983 4.247e-01 -1.146e+04  4.827e+03 46173
gic201050           -3.210e+03  4.276e+03 -0.7507 4.528e-01 -1.159e+04  5.171e+03 46173
gic201060           -3.547e+03  4.126e+03 -0.8596 3.900e-01 -1.163e+04  4.540e+03 46173
gic201070           -2.772e+03  4.168e+03 -0.6652 5.059e-01 -1.094e+04  5.397e+03 46173
gic202010           -3.683e+03  4.130e+03 -0.8919 3.724e-01 -1.178e+04  4.411e+03 46173
gic202020           -3.746e+03  4.141e+03 -0.9045 3.657e-01 -1.186e+04  4.371e+03 46173
gic203010           -4.001e+03  4.210e+03 -0.9504 3.419e-01 -1.225e+04  4.250e+03 46173
gic203020           -2.605e+03  4.237e+03 -0.6149 5.386e-01 -1.091e+04  5.699e+03 46173
gic203030           -2.649e+03  4.295e+03 -0.6169 5.373e-01 -1.107e+04  5.768e+03 46173
gic203040           -2.978e+03  4.136e+03 -0.7201 4.715e-01 -1.108e+04  5.128e+03 46173
gic203050           -4.648e+03  5.215e+03 -0.8913 3.728e-01 -1.487e+04  5.573e+03 46173
gic251010           -3.718e+03  4.167e+03 -0.8922 3.723e-01 -1.189e+04  4.450e+03 46173
gic251020           -3.928e+03  4.641e+03 -0.8464 3.973e-01 -1.302e+04  5.168e+03 46173
gic252010           -4.046e+03  4.137e+03 -0.9781 3.280e-01 -1.215e+04  4.062e+03 46173
gic252020           -2.654e+03  4.219e+03 -0.6292 5.292e-01 -1.092e+04  5.615e+03 46173
gic252030           -4.785e+03  4.142e+03 -1.1552 2.480e-01 -1.290e+04  3.334e+03 46173
gic253010           -3.300e+03  4.121e+03 -0.8006 4.233e-01 -1.138e+04  4.778e+03 46173
gic253020           -3.314e+03  4.164e+03 -0.7959 4.261e-01 -1.147e+04  4.847e+03 46173
gic254010           -3.599e+03  4.158e+03 -0.8655 3.868e-01 -1.175e+04  4.551e+03 46173
gic255010           -3.310e+03  4.178e+03 -0.7923 4.282e-01 -1.150e+04  4.878e+03 46173
gic255020           -3.235e+03  4.181e+03 -0.7737 4.391e-01 -1.143e+04  4.960e+03 46173
gic255030           -3.124e+03  4.165e+03 -0.7501 4.532e-01 -1.129e+04  5.039e+03 46173
gic255040           -3.817e+03  4.121e+03 -0.9262 3.544e-01 -1.189e+04  4.261e+03 46173
gic301010           -2.420e+03  4.195e+03 -0.5767 5.641e-01 -1.064e+04  5.803e+03 46173
gic302010           -2.947e+03  4.168e+03 -0.7071 4.795e-01 -1.112e+04  5.222e+03 46173
gic302020           -3.128e+03  4.161e+03 -0.7518 4.522e-01 -1.128e+04  5.027e+03 46173
gic302030           -2.642e+03  4.251e+03 -0.6215 5.343e-01 -1.097e+04  5.689e+03 46173
gic303010           -2.467e+03  4.350e+03 -0.5670 5.707e-01 -1.099e+04  6.060e+03 46173
gic303020           -4.049e+03  4.194e+03 -0.9653 3.344e-01 -1.227e+04  4.172e+03 46173
gic351010           -2.665e+03  4.121e+03 -0.6468 5.178e-01 -1.074e+04  5.411e+03 46173
gic351020           -3.427e+03  4.122e+03 -0.8313 4.058e-01 -1.151e+04  4.653e+03 46173
gic351030           -1.938e+03  4.236e+03 -0.4575 6.473e-01 -1.024e+04  6.365e+03 46173
gic352010           -1.981e+03  4.113e+03 -0.4817 6.300e-01 -1.004e+04  6.080e+03 46173
gic352020           -2.684e+03  4.131e+03 -0.6497 5.159e-01 -1.078e+04  5.413e+03 46173
gic352030           -2.001e+03  4.162e+03 -0.4808 6.307e-01 -1.016e+04  6.157e+03 46173
gic401010           -2.776e+03  4.107e+03 -0.6758 4.991e-01 -1.083e+04  5.274e+03 46173
gic401020           -2.879e+03  4.120e+03 -0.6989 4.846e-01 -1.095e+04  5.196e+03 46173
gic402010           -2.992e+03  4.234e+03 -0.7067 4.797e-01 -1.129e+04  5.306e+03 46173
gic402020           -3.552e+03  4.169e+03 -0.8521 3.942e-01 -1.172e+04  4.619e+03 46173
gic402030           -3.211e+03  4.125e+03 -0.7784 4.363e-01 -1.130e+04  4.874e+03 46173
gic402040           -3.552e+03  4.177e+03 -0.8505 3.951e-01 -1.174e+04  4.634e+03 46173
gic403010           -3.333e+03  4.116e+03 -0.8099 4.180e-01 -1.140e+04  4.733e+03 46173
gic404010           -3.624e+03  4.209e+03 -0.8610 3.892e-01 -1.187e+04  4.625e+03 46173
gic404020           -2.706e+03  4.144e+03 -0.6530 5.138e-01 -1.083e+04  5.417e+03 46173
gic404030           -3.315e+03  4.675e+03 -0.7092 4.782e-01 -1.248e+04  5.847e+03 46173
gic451010           -2.136e+03  4.158e+03 -0.5137 6.075e-01 -1.028e+04  6.014e+03 46173
gic451020           -2.779e+03  4.130e+03 -0.6729 5.010e-01 -1.087e+04  5.316e+03 46173
gic451030           -3.179e+03  4.124e+03 -0.7708 4.408e-01 -1.126e+04  4.905e+03 46173
gic452010           -4.444e+03  4.150e+03 -1.0709 2.842e-01 -1.258e+04  3.690e+03 46173
gic452020           -3.845e+03  4.191e+03 -0.9175 3.589e-01 -1.206e+04  4.369e+03 46173
gic452030           -3.489e+03  4.126e+03 -0.8457 3.977e-01 -1.158e+04  4.598e+03 46173
gic452040            9.771e+03  9.828e+03  0.9943 3.201e-01 -9.491e+03  2.903e+04 46173
gic452050           -8.697e+03  4.715e+03 -1.8448 6.508e-02 -1.794e+04  5.434e+02 46173
gic453010           -4.158e+03  4.138e+03 -1.0049 3.150e-01 -1.227e+04  3.953e+03 46173
gic501010           -3.050e+03  4.169e+03 -0.7316 4.644e-01 -1.122e+04  5.121e+03 46173
gic501020           -2.003e+03  4.281e+03 -0.4678 6.399e-01 -1.039e+04  6.387e+03 46173
gic502010           -2.648e+03  4.165e+03 -0.6356 5.250e-01 -1.081e+04  5.517e+03 46173
gic502020           -2.168e+03  4.231e+03 -0.5125 6.083e-01 -1.046e+04  6.124e+03 46173
gic502030           -1.171e+03  4.388e+03 -0.2667 7.897e-01 -9.771e+03  7.430e+03 46173
gic551010           -3.355e+03  4.124e+03 -0.8136 4.159e-01 -1.144e+04  4.728e+03 46173
gic551020           -2.597e+03  4.173e+03 -0.6223 5.338e-01 -1.078e+04  5.583e+03 46173
gic551030           -3.344e+03  4.132e+03 -0.8094 4.183e-01 -1.144e+04  4.754e+03 46173
gic551040           -3.190e+03  4.120e+03 -0.7743 4.387e-01 -1.126e+04  4.885e+03 46173
gic551050           -2.416e+03  4.369e+03 -0.5529 5.803e-01 -1.098e+04  6.147e+03 46173
gic601010           -2.624e+03  4.113e+03 -0.6379 5.235e-01 -1.069e+04  5.438e+03 46173
gic601020           -3.677e+03  4.235e+03 -0.8684 3.852e-01 -1.198e+04  4.623e+03 46173
year1995            -2.892e+03  1.177e+03 -2.4574 1.400e-02 -5.199e+03 -5.854e+02 46173
year1996            -2.881e+03  8.516e+02 -3.3833 7.167e-04 -4.550e+03 -1.212e+03 46173
year1997            -2.669e+03  8.056e+02 -3.3127 9.246e-04 -4.248e+03 -1.090e+03 46173
year1998            -4.375e+03  8.114e+02 -5.3917 7.014e-08 -5.965e+03 -2.784e+03 46173
year1999            -2.656e+03  8.189e+02 -3.2430 1.184e-03 -4.260e+03 -1.051e+03 46173
year2001            -4.996e+03  8.073e+02 -6.1889 6.110e-10 -6.579e+03 -3.414e+03 46173
year2002            -2.353e+03  8.377e+02 -2.8086 4.978e-03 -3.995e+03 -7.108e+02 46173
year2003            -9.580e+02  7.910e+02 -1.2110 2.259e-01 -2.508e+03  5.925e+02 46173
year2004            -4.994e+02  7.926e+02 -0.6301 5.287e-01 -2.053e+03  1.054e+03 46173
year2005            -2.285e+03  7.889e+02 -2.8963 3.778e-03 -3.831e+03 -7.387e+02 46173
year2006            -2.437e+03  7.919e+02 -3.0771 2.092e-03 -3.989e+03 -8.846e+02 46173
year2007            -3.443e+03  7.941e+02 -4.3360 1.454e-05 -4.999e+03 -1.887e+03 46173
year2008            -6.423e+03  8.012e+02 -8.0170 1.109e-15 -7.993e+03 -4.853e+03 46173
year2009            -3.738e+03  8.071e+02 -4.6315 3.641e-06 -5.320e+03 -2.156e+03 46173
year2010             9.338e+02  8.060e+02  1.1585 2.466e-01 -6.460e+02  2.514e+03 46173
year2011            -1.580e+03  7.876e+02 -2.0060 4.486e-02 -3.123e+03 -3.622e+01 46173
year2012            -3.116e+03  7.867e+02 -3.9604 7.495e-05 -4.658e+03 -1.574e+03 46173
year2013            -2.760e+03  7.841e+02 -3.5197 4.324e-04 -4.297e+03 -1.223e+03 46173
year2014            -2.331e+03  7.810e+02 -2.9845 2.842e-03 -3.862e+03 -8.001e+02 46173
year2015            -3.637e+03  7.863e+02 -4.6255 3.748e-06 -5.178e+03 -2.096e+03 46173
year2017            -1.984e+03  7.869e+02 -2.5214 1.169e-02 -3.527e+03 -4.418e+02 46173
year2018            -1.669e+03  7.905e+02 -2.1114 3.475e-02 -3.218e+03 -1.196e+02 46173

Multiple R-squared:  0.01574 ,	Adjusted R-squared:  0.0136 
F-statistic:  6.71 on 100 and 46173 DF,  p-value: < 2.2e-16






Call:
  lm_robust(formula = as.double(roac1) ~ as.double(percwrds) + 
              log(length) + log(as.double(BOV)) + gic + as.double(roac) + 
              year, data = subset(`vectorfinal(7)`))

Standard error type:  HC2 

Coefficients:
  Estimate Std. Error    t value  Pr(>|t|)   CI Lower   CI Upper    DF
(Intercept)         -4.602e+03  2.990e+03  -1.539286 1.237e-01 -1.046e+04  1.258e+03 46171
as.double(percwrds)  2.486e-02  1.418e-02   1.753405 7.954e-02 -2.930e-03  5.266e-02 46171
log(length)          4.547e+02  6.913e+01   6.578170 4.813e-11  3.192e+02  5.902e+02 46171
log(as.double(BOV))  5.268e+01  3.683e+01   1.430223 1.527e-01 -1.951e+01  1.249e+02 46171
gic101010           -2.347e+03  2.923e+03  -0.803126 4.219e-01 -8.076e+03  3.381e+03 46171
gic101020           -1.749e+03  2.895e+03  -0.604140 5.458e-01 -7.422e+03  3.925e+03 46171
gic151010           -8.041e+02  2.916e+03  -0.275755 7.827e-01 -6.519e+03  4.911e+03 46171
gic151020            6.881e+01  3.242e+03   0.021225 9.831e-01 -6.285e+03  6.423e+03 46171
gic151030           -2.829e+02  2.977e+03  -0.095041 9.243e-01 -6.118e+03  5.552e+03 46171
gic151040           -6.324e+02  2.931e+03  -0.215770 8.292e-01 -6.377e+03  5.112e+03 46171
gic151050           -6.451e+02  3.063e+03  -0.210633 8.332e-01 -6.648e+03  5.358e+03 46171
gic201010           -7.951e+02  2.948e+03  -0.269725 7.874e-01 -6.573e+03  4.982e+03 46171
gic201020           -2.596e+00  2.950e+03  -0.000880 9.993e-01 -5.785e+03  5.780e+03 46171
gic201030           -1.521e+03  2.970e+03  -0.512004 6.087e-01 -7.342e+03  4.301e+03 46171
gic201040           -2.992e+02  2.933e+03  -0.101993 9.188e-01 -6.048e+03  5.450e+03 46171
gic201050           -1.917e+03  3.062e+03  -0.626215 5.312e-01 -7.918e+03  4.084e+03 46171
gic201060           -1.144e+03  2.903e+03  -0.394239 6.934e-01 -6.834e+03  4.545e+03 46171
gic201070           -1.464e+03  2.940e+03  -0.498032 6.185e-01 -7.228e+03  4.299e+03 46171
gic202010           -7.553e+02  2.909e+03  -0.259663 7.951e-01 -6.456e+03  4.946e+03 46171
gic202020           -1.499e+03  2.923e+03  -0.512838 6.081e-01 -7.227e+03  4.229e+03 46171
gic203010           -2.323e+03  2.977e+03  -0.780220 4.353e-01 -8.159e+03  3.513e+03 46171
gic203020            1.699e+01  3.022e+03   0.005622 9.955e-01 -5.906e+03  5.940e+03 46171
gic203030           -1.626e+03  3.026e+03  -0.537304 5.911e-01 -7.557e+03  4.305e+03 46171
gic203040           -5.220e+02  2.915e+03  -0.179071 8.579e-01 -6.236e+03  5.192e+03 46171
gic203050           -3.698e+03  4.290e+03  -0.861962 3.887e-01 -1.211e+04  4.711e+03 46171
gic251010           -4.416e+02  2.959e+03  -0.149250 8.814e-01 -6.241e+03  5.358e+03 46171
gic251020           -1.210e+03  3.245e+03  -0.372799 7.093e-01 -7.569e+03  5.150e+03 46171
gic252010           -1.562e+03  2.916e+03  -0.535791 5.921e-01 -7.278e+03  4.153e+03 46171
gic252020           -5.559e+02  2.998e+03  -0.185422 8.529e-01 -6.432e+03  5.320e+03 46171
gic252030           -1.352e+03  2.915e+03  -0.463742 6.428e-01 -7.065e+03  4.361e+03 46171
gic253010           -6.955e+02  2.898e+03  -0.240029 8.103e-01 -6.375e+03  4.984e+03 46171
gic253020           -1.148e+03  2.956e+03  -0.388410 6.977e-01 -6.941e+03  4.645e+03 46171
gic254010           -2.949e+02  2.949e+03  -0.099995 9.203e-01 -6.074e+03  5.485e+03 46171
gic255010            3.227e+02  3.003e+03   0.107478 9.144e-01 -5.563e+03  6.208e+03 46171
gic255020           -1.195e+03  2.963e+03  -0.403346 6.867e-01 -7.002e+03  4.612e+03 46171
gic255030           -2.713e+03  2.982e+03  -0.909882 3.629e-01 -8.557e+03  3.131e+03 46171
gic255040           -1.438e+03  2.901e+03  -0.495821 6.200e-01 -7.124e+03  4.247e+03 46171
gic301010           -7.345e+02  2.954e+03  -0.248647 8.036e-01 -6.525e+03  5.056e+03 46171
gic302010           -6.017e+02  2.943e+03  -0.204451 8.380e-01 -6.370e+03  5.167e+03 46171
gic302020           -1.759e+03  2.944e+03  -0.597595 5.501e-01 -7.530e+03  4.011e+03 46171
gic302030           -2.023e+03  3.073e+03  -0.658237 5.104e-01 -8.046e+03  4.001e+03 46171
gic303010           -8.928e+02  3.274e+03  -0.272713 7.851e-01 -7.310e+03  5.524e+03 46171
gic303020           -1.830e+03  2.979e+03  -0.614151 5.391e-01 -7.669e+03  4.010e+03 46171
gic351010            2.564e+02  2.898e+03   0.088478 9.295e-01 -5.424e+03  5.937e+03 46171
gic351020           -8.926e+02  2.898e+03  -0.308013 7.581e-01 -6.573e+03  4.787e+03 46171
gic351030           -6.509e+02  3.006e+03  -0.216498 8.286e-01 -6.543e+03  5.242e+03 46171
gic352010            9.065e+02  2.889e+03   0.313766 7.537e-01 -4.756e+03  6.569e+03 46171
gic352020            3.624e+02  2.911e+03   0.124495 9.009e-01 -5.343e+03  6.068e+03 46171
gic352030           -3.309e+02  2.941e+03  -0.112487 9.104e-01 -6.096e+03  5.434e+03 46171
gic401010            8.725e+01  2.883e+03   0.030263 9.759e-01 -5.563e+03  5.738e+03 46171
gic401020           -1.134e+02  2.896e+03  -0.039173 9.688e-01 -5.789e+03  5.562e+03 46171
gic402010           -5.644e+01  3.024e+03  -0.018664 9.851e-01 -5.983e+03  5.870e+03 46171
gic402020           -2.606e+02  2.952e+03  -0.088275 9.297e-01 -6.048e+03  5.526e+03 46171
gic402030           -6.476e+02  2.903e+03  -0.223059 8.235e-01 -6.338e+03  5.043e+03 46171
gic402040           -1.395e+03  2.948e+03  -0.473234 6.360e-01 -7.173e+03  4.383e+03 46171
gic403010           -6.223e+02  2.892e+03  -0.215168 8.296e-01 -6.291e+03  5.046e+03 46171
gic404010            8.016e+02  2.970e+03   0.269918 7.872e-01 -5.019e+03  6.623e+03 46171
gic404020           -1.695e+02  2.924e+03  -0.057982 9.538e-01 -5.901e+03  5.561e+03 46171
gic404030           -9.883e+02  3.421e+03  -0.288884 7.727e-01 -7.694e+03  5.717e+03 46171
gic451010            3.815e+02  2.941e+03   0.129741 8.968e-01 -5.382e+03  6.145e+03 46171
gic451020           -6.575e+02  2.908e+03  -0.226141 8.211e-01 -6.356e+03  5.041e+03 46171
gic451030           -2.520e+02  2.900e+03  -0.086894 9.308e-01 -5.936e+03  5.432e+03 46171
gic452010           -1.568e+03  2.921e+03  -0.537016 5.913e-01 -7.293e+03  4.156e+03 46171
gic452020           -1.474e+03  2.969e+03  -0.496430 6.196e-01 -7.293e+03  4.345e+03 46171
gic452030           -8.799e+02  2.902e+03  -0.303253 7.617e-01 -6.567e+03  4.807e+03 46171
gic452040           -1.255e+04  1.326e+04  -0.946998 3.436e-01 -3.854e+04  1.343e+04 46171
gic452050           -5.553e+03  3.597e+03  -1.543770 1.227e-01 -1.260e+04  1.497e+03 46171
gic453010           -1.546e+02  2.916e+03  -0.053001 9.577e-01 -5.870e+03  5.561e+03 46171
gic501010           -8.578e+02  2.949e+03  -0.290875 7.711e-01 -6.638e+03  4.923e+03 46171
gic501020            1.208e+01  3.077e+03   0.003926 9.969e-01 -6.020e+03  6.044e+03 46171
gic502010            4.785e+02  2.940e+03   0.162757 8.707e-01 -5.284e+03  6.241e+03 46171
gic502020           -3.808e+01  3.021e+03  -0.012604 9.899e-01 -5.959e+03  5.883e+03 46171
gic502030            8.335e+02  3.122e+03   0.267008 7.895e-01 -5.285e+03  6.952e+03 46171
gic551010           -4.675e+02  2.902e+03  -0.161106 8.720e-01 -6.155e+03  5.220e+03 46171
gic551020           -1.039e+03  2.937e+03  -0.353814 7.235e-01 -6.797e+03  4.718e+03 46171
gic551030           -9.673e+02  2.906e+03  -0.332892 7.392e-01 -6.663e+03  4.728e+03 46171
gic551040           -6.145e+02  2.906e+03  -0.211498 8.325e-01 -6.310e+03  5.081e+03 46171
gic551050           -9.184e+02  3.160e+03  -0.290608 7.714e-01 -7.113e+03  5.276e+03 46171
gic601010            8.573e+01  2.889e+03   0.029674 9.763e-01 -5.577e+03  5.748e+03 46171
gic601020           -5.663e+02  3.015e+03  -0.187846 8.510e-01 -6.475e+03  5.343e+03 46171
as.double(roac)     -3.105e-01  5.127e-03 -60.570651 0.000e+00 -3.206e-01 -3.005e-01 46171
year1995            -1.668e+03  1.011e+03  -1.650853 9.878e-02 -3.649e+03  3.124e+02 46171
year1996            -1.328e+03  7.222e+02  -1.838634 6.598e-02 -2.743e+03  8.766e+01 46171
year1997            -3.513e+03  6.919e+02  -5.076924 3.851e-07 -4.869e+03 -2.157e+03 46171
year1998            -2.955e+03  6.937e+02  -4.259419 2.054e-05 -4.315e+03 -1.595e+03 46171
year1999            -2.211e+03  6.984e+02  -3.166451 1.544e-03 -3.580e+03 -8.425e+02 46171
year2001            -1.509e+03  6.847e+02  -2.203928 2.753e-02 -2.851e+03 -1.670e+02 46171
year2002            -4.698e+02  7.145e+02  -0.657554 5.108e-01 -1.870e+03  9.306e+02 46171
year2003             3.522e+02  6.824e+02   0.516181 6.057e-01 -9.853e+02  1.690e+03 46171
year2004            -1.340e+03  6.772e+02  -1.979152 4.780e-02 -2.668e+03 -1.296e+01 46171
year2005            -1.992e+03  6.834e+02  -2.915216 3.556e-03 -3.332e+03 -6.528e+02 46171
year2006            -3.133e+03  6.796e+02  -4.609759 4.042e-06 -4.465e+03 -1.801e+03 46171
year2007            -6.573e+03  6.935e+02  -9.478710 2.692e-21 -7.932e+03 -5.214e+03 46171
year2008            -4.422e+03  6.945e+02  -6.367705 1.937e-10 -5.784e+03 -3.061e+03 46171
year2009             6.976e+02  6.908e+02   1.009788 3.126e-01 -6.564e+02  2.052e+03 46171
year2010            -5.715e+02  6.845e+02  -0.834842 4.038e-01 -1.913e+03  7.702e+02 46171
year2011            -2.417e+03  6.798e+02  -3.554835 3.786e-04 -3.749e+03 -1.084e+03 46171
year2012            -2.520e+03  6.757e+02  -3.728762 1.927e-04 -3.844e+03 -1.195e+03 46171
year2013            -2.122e+03  6.768e+02  -3.135079 1.719e-03 -3.448e+03 -7.953e+02 46171
year2014            -3.322e+03  6.770e+02  -4.906566 9.300e-07 -4.649e+03 -1.995e+03 46171
year2015            -2.472e+03  6.736e+02  -3.669169 2.436e-04 -3.792e+03 -1.151e+03 46171
year2017            -1.270e+03  6.799e+02  -1.867289 6.187e-02 -2.602e+03  6.305e+01 46171
year2018            -2.915e+03  6.785e+02  -4.296347 1.740e-05 -4.245e+03 -1.585e+03 46171

Multiple R-squared:  0.1281 ,	Adjusted R-squared:  0.1262 
F-statistic: 44.51 on 102 and 46171 DF,  p-value: < 2.2e-16

"""


#However, based on our performance dictionary, we make additional observation that whilst it is indeed true that the disclosure of negative performance is
# correlated with negative performance. To study if companies disclose positive performance as it is, we divided positive performance into 
# negneg, whereby company discloses that it is trying to counteract negative performance (eg. reduce costs, reduce liabilities) and posl, whereby company simply tries 
# discusses positive performance (eg. increase in revenue). It is observed that company's description to counteract negative performance is correlated with performance improvement
# whereby the disclosure of existing positive performance is negatively correlated with performance improvement


reg = lm_robust(as.double(roac) ~ as.double(posl)+ as.double(negl)+ as.double(negneg)+log(as.double(BOV))+gic+year, data = `vectorfinal(7)`)
summary(reg)

"""

Coefficients:
Estimate Std. Error  t value  Pr(>|t|)   CI Lower   CI Upper    DF
(Intercept)             -2880.272  3.327e+02  -8.6561 4.964e-18 -3.532e+03 -2.228e+03 87722
as.double(posl)        -85989.695  1.721e+04  -4.9975 5.819e-07 -1.197e+05 -5.227e+04 87722
as.double(negl)        -15473.569  3.517e+03  -4.3993 1.087e-05 -2.237e+04 -8.580e+03 87722
as.double(negneg)      149260.523  1.666e+04   8.9592 3.332e-19  1.166e+05  1.819e+05 87722
log(as.double(length))    179.507  2.823e+01   6.3591 2.040e-10  1.242e+02  2.348e+02 87722
log(as.double(BOV))        40.185  2.967e+01   1.3542 1.757e-01 -1.797e+01  9.834e+01 87722
gic101010               -3520.543  6.678e+02  -5.2716 1.356e-07 -4.829e+03 -2.212e+03 87722
gic101020               -3097.211  5.408e+02  -5.7272 1.024e-08 -4.157e+03 -2.037e+03 87722
gic151010               -2401.499  6.409e+02  -3.7473 1.788e-04 -3.658e+03 -1.145e+03 87722
gic151020               -1897.118  1.522e+03  -1.2465 2.126e-01 -4.880e+03  1.086e+03 87722
gic151030               -1608.138  8.638e+02  -1.8616 6.266e-02 -3.301e+03  8.499e+01 87722
gic151040               -1655.705  6.855e+02  -2.4155 1.572e-02 -2.999e+03 -3.122e+02 87722
gic151050               -2135.003  1.091e+03  -1.9563 5.044e-02 -4.274e+03  4.064e+00 87722
gic201010               -2787.161  7.606e+02  -3.6643 2.481e-04 -4.278e+03 -1.296e+03 87722
gic201020               -1573.262  7.734e+02  -2.0343 4.193e-02 -3.089e+03 -5.746e+01 87722
gic201030               -2294.453  8.379e+02  -2.7384 6.175e-03 -3.937e+03 -6.522e+02 87722
gic201040               -1694.323  7.073e+02  -2.3955 1.660e-02 -3.081e+03 -3.080e+02 87722
gic201050               -3024.981  1.166e+03  -2.5951 9.458e-03 -5.310e+03 -7.403e+02 87722
gic201060               -2568.519  5.849e+02  -4.3916 1.127e-05 -3.715e+03 -1.422e+03 87722
gic201070               -2713.530  7.566e+02  -3.5865 3.353e-04 -4.196e+03 -1.231e+03 87722
gic202010               -2283.285  5.939e+02  -3.8443 1.210e-04 -3.447e+03 -1.119e+03 87722
gic202020               -2479.667  6.764e+02  -3.6659 2.466e-04 -3.805e+03 -1.154e+03 87722
gic203010               -3250.159  9.502e+02  -3.4203 6.258e-04 -5.113e+03 -1.388e+03 87722
gic203020               -1089.159  1.004e+03  -1.0848 2.780e-01 -3.057e+03  8.788e+02 87722
gic203030               -2581.608  1.026e+03  -2.5160 1.187e-02 -4.593e+03 -5.705e+02 87722
gic203040               -2005.201  6.422e+02  -3.1225 1.794e-03 -3.264e+03 -7.466e+02 87722
gic203050               -3851.675  2.689e+03  -1.4322 1.521e-01 -9.123e+03  1.419e+03 87722
gic251010               -1713.021  7.939e+02  -2.1579 3.094e-02 -3.269e+03 -1.571e+02 87722
gic251020               -2617.768  1.477e+03  -1.7727 7.628e-02 -5.512e+03  2.766e+02 87722
gic252010               -2907.164  6.439e+02  -4.5150 6.340e-06 -4.169e+03 -1.645e+03 87722
gic252020               -2013.518  9.027e+02  -2.2306 2.571e-02 -3.783e+03 -2.443e+02 87722
gic252030               -2890.574  6.457e+02  -4.4766 7.594e-06 -4.156e+03 -1.625e+03 87722
gic253010               -2020.124  5.606e+02  -3.6036 3.140e-04 -3.119e+03 -9.214e+02 87722
gic253020               -2321.083  8.044e+02  -2.8855 3.909e-03 -3.898e+03 -7.445e+02 87722
gic254010               -2347.128  7.420e+02  -3.1631 1.562e-03 -3.802e+03 -8.927e+02 87722
gic255010               -1309.851  9.495e+02  -1.3795 1.677e-01 -3.171e+03  5.511e+02 87722
gic255020               -2414.143  8.112e+02  -2.9759 2.922e-03 -4.004e+03 -8.242e+02 87722
gic255030               -4384.673  9.168e+02  -4.7826 1.733e-06 -6.182e+03 -2.588e+03 87722
gic255040               -2949.817  5.773e+02  -5.1097 3.233e-07 -4.081e+03 -1.818e+03 87722
gic301010               -2591.918  8.207e+02  -3.1582 1.588e-03 -4.200e+03 -9.834e+02 87722
gic302010               -1953.539  7.667e+02  -2.5479 1.084e-02 -3.456e+03 -4.508e+02 87722
gic302020               -3005.846  7.282e+02  -4.1281 3.662e-05 -4.433e+03 -1.579e+03 87722
gic302030               -5012.503  1.427e+03  -3.5138 4.419e-04 -7.808e+03 -2.217e+03 87722
gic303010               -1647.847  1.537e+03  -1.0720 2.837e-01 -4.661e+03  1.365e+03 87722
gic303020               -3220.546  8.606e+02  -3.7422 1.826e-04 -4.907e+03 -1.534e+03 87722
gic351010               -1477.960  5.517e+02  -2.6787 7.392e-03 -2.559e+03 -3.966e+02 87722
gic351020               -2621.640  5.554e+02  -4.7201 2.361e-06 -3.710e+03 -1.533e+03 87722
gic351030               -2307.940  9.359e+02  -2.4659 1.367e-02 -4.142e+03 -4.735e+02 87722
gic352010                -258.404  5.003e+02  -0.5165 6.055e-01 -1.239e+03  7.222e+02 87722
gic352020               -1067.472  6.029e+02  -1.7706 7.663e-02 -2.249e+03  1.142e+02 87722
gic352030               -1882.738  7.274e+02  -2.5884 9.643e-03 -3.308e+03 -4.571e+02 87722
gic401010                -775.622  4.697e+02  -1.6515 9.865e-02 -1.696e+03  1.449e+02 87722
gic401020               -1019.764  5.316e+02  -1.9182 5.509e-02 -2.062e+03  2.221e+01 87722
gic402010               -2644.969  9.340e+02  -2.8319 4.628e-03 -4.476e+03 -8.143e+02 87722
gic402020               -1501.199  8.008e+02  -1.8746 6.085e-02 -3.071e+03  6.836e+01 87722
gic402030               -1588.872  5.747e+02  -2.7647 5.699e-03 -2.715e+03 -4.625e+02 87722
gic402040               -2117.719  7.688e+02  -2.7544 5.881e-03 -3.625e+03 -6.108e+02 87722
gic403010               -1867.086  5.279e+02  -3.5368 4.052e-04 -2.902e+03 -8.324e+02 87722
gic404010               -2716.758  8.525e+02  -3.1870 1.438e-03 -4.388e+03 -1.046e+03 87722
gic404020               -1874.205  6.881e+02  -2.7236 6.458e-03 -3.223e+03 -5.255e+02 87722
gic404030                -857.917  1.786e+03  -0.4802 6.311e-01 -4.359e+03  2.643e+03 87722
gic451010                -934.254  6.831e+02  -1.3676 1.715e-01 -2.273e+03  4.047e+02 87722
gic451020               -2016.016  5.978e+02  -3.3723 7.458e-04 -3.188e+03 -8.443e+02 87722
gic451030               -1590.916  5.560e+02  -2.8613 4.220e-03 -2.681e+03 -5.011e+02 87722
gic452010               -2625.841  6.303e+02  -4.1660 3.103e-05 -3.861e+03 -1.390e+03 87722
gic452020               -2525.166  7.948e+02  -3.1771 1.488e-03 -4.083e+03 -9.673e+02 87722
gic452030               -2329.310  5.704e+02  -4.0835 4.440e-05 -3.447e+03 -1.211e+03 87722
gic452040              -21440.891  8.521e+03  -2.5162 1.186e-02 -3.814e+04 -4.740e+03 87722
gic452050               -7207.859  1.801e+03  -4.0028 6.266e-05 -1.074e+04 -3.678e+03 87722
gic453010               -1335.753  6.305e+02  -2.1184 3.414e-02 -2.572e+03 -9.991e+01 87722
gic501010               -1715.680  7.315e+02  -2.3453 1.902e-02 -3.150e+03 -2.819e+02 87722
gic501020                -644.546  1.050e+03  -0.6139 5.393e-01 -2.702e+03  1.413e+03 87722
gic502010                -635.911  7.600e+02  -0.8368 4.027e-01 -2.125e+03  8.536e+02 87722
gic502020                -628.132  9.866e+02  -0.6366 5.244e-01 -2.562e+03  1.306e+03 87722
gic502030                -456.828  1.265e+03  -0.3612 7.179e-01 -2.936e+03  2.022e+03 87722
gic551010               -2244.347  5.832e+02  -3.8481 1.191e-04 -3.387e+03 -1.101e+03 87722
gic551020               -3130.622  7.994e+02  -3.9161 9.006e-05 -4.697e+03 -1.564e+03 87722
gic551030               -2161.006  6.040e+02  -3.5780 3.465e-04 -3.345e+03 -9.772e+02 87722
gic551040               -1673.655  5.956e+02  -2.8102 4.952e-03 -2.841e+03 -5.064e+02 87722
gic551050               -1357.643  1.233e+03  -1.1013 2.708e-01 -3.774e+03  1.058e+03 87722
gic601010                -845.399  5.144e+02  -1.6436 1.003e-01 -1.854e+03  1.628e+02 87722
gic601020               -1380.683  1.007e+03  -1.3716 1.702e-01 -3.354e+03  5.923e+02 87722
as.double(roac)            -0.289  4.344e-03 -66.5241 0.000e+00 -2.975e-01 -2.805e-01 87722

Multiple R-squared:  0.1117 ,	Adjusted R-squared:  0.1109 
F-statistic: 64.07 on 82 and 87722 DF,  p-value: < 2.2e-16


"""
library(dplyr)

# Struggling to implement fixed effect 

`vectorfinal(7)`$id <- group_indices(`vectorfinal(7)`, cik, year)    
#which would be the same as my.data <- my.data %>% mutate(id = group_indices(st_name, race)), if this function supported mutate. 

rm(large_df, large_list,large_vector,temp_variables) 

plm.reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+year+as.double(roac),
               data = `vectorfinal(7)`, index=c("cik"), model = "within")

summary(plm.reg)

#summary(reg)

roac1 = `vectorfinal(7)`$roac1
percwrds = `vectorfinal(7)`$percwrds
length=`vectorfinal(7)`$length
BOV=`vectorfinal(7)`$BOV
roac=`vectorfinal(7)`$roac
gic=`vectorfinal(7)`$gic
cik=`vectorfinal(7)`$cik


plm.reg <- lm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+year+as.double(roac)+gic, data = `vectorfinal(7)`)
               

coeftest(plm.reg , vcov=vcovHC(plm.reg ,type="HC0",cluster="gic"), data = `vectorfinal(7)`)




plm.reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+year+as.double(roac),
               data = `vectorfinal(7)`, index=c("gic"), model = "within")

summary(plm.reg)


plm.reg <- lm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+year+as.double(roac)+gic,
               data = `vectorfinal(7)`)

summary(plm.reg)

plm.reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+year+as.double(roac),
               data = `vectorfinal(7)`, index=c("cik"), model = "within")

summary(plm.reg)





plm.reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+as.double(roac),
               data = `vectorfinal(7)`, index=c("filename","year"), model = "within",
               effect = "twoways")


reg <- lm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+as.double(roac)+as.character(gic), 
                 data = `vectorfinal(7)`)

summary(reg)

roac1 = `vectorfinal(7)`$roac1
percwrds = `vectorfinal(7)`$percwrds
length=`vectorfinal(7)`$length
BOV=`vectorfinal(7)`$BOV
roac=`vectorfinal(7)`$roac
gic=`vectorfinal(7)`$gic
cik=`vectorfinal(7)`$cik


coeftest(reg, vcov=vcovHC(reg,type="HC0",cluster="gic"), data = `vectorfinal(7)`)


fatal_fe_mod <- plm(fatal_rate ~ beertax, 
                    data = Fatalities,
                    index = c("cik", "cikyear"), 
                    model = "within")

table(index(`vectorfinal(7)`), useNA = "ifany")


reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+as.double(roac), 
           data = `vectorfinal(7)`,
           model = "within",
           index=c("cik","cikyear"))


`vectorfinal(7)`$cikyear <- paste(`vectorfinal(7)`$cik, `vectorfinal(7)`$year, sep="_")
Produc_plm2 <- pdata.frame(Produc, index = c("region", "year_state"))


Produc_plm2 <- pdata.frame(`vectorfinal(7)`, index = c("cik", "cikyear"))

#reg_plm_2 <- plm(gsp ~ pcap, data = Produc_plm2)

reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+as.double(roac), 
           data = `vectorfinal(7)`,
           model = "within",
           index=c("cikyear","year"))

reg <- plm(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+as.double(roac), 
                    data = `vectorfinal(7)`,
                    model = "within",
                    index=c("gic","year"))

coeftest(model, vcovHC(model, type = 'HC0', cluster = 'gic'))


reg <- lm_robust(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+as.double(roac)+factor(gic), 
           data = `vectorfinal(7)`)

ct.lsdv <- coeftest(reg, vcov. = vcovHC)

summary(ct.lsdv)

reg = lm_robust(as.double(roac1) ~ as.double(percwrds)+log(length)+log(as.double(BOV))+gic+as.double(roac), data = subset(`vectorfinal(7)`))
summary(reg)