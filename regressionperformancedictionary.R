library(readr)
#install.packages("estimatr")
#install.packages("margins")
#install.packages("car")
library(estimatr)
library(margins)
library(car)
#summary(regression1)


#install.packages("plyr")
#install.packages("ggplot2")
#install.packages("lmtest")



library(plyr)
library(ggplot2)
library(lmtest)
library(sandwich)

#install.packages("plm")

library(plm)

#install.packages("sandwich")

library(sandwich)


#In the most desired regression model, we would ideally like to fomulate as the following: 

#1. Change in ROA= beta1*book to market ratio+beta2*market cap+beta3*industry dummy+beta4*percwrds+beta5*change in ROA in the previous period
#2. Change in ROA= beta1*book to market ratio+beta2*market cap+beta3*industry dummy+beta4*posl+beta5*negl+beta6*negneg+beta7*change in ROA in the previous period

#However, market cap (MKVALT) has too many missing values and this significantly restricts the sample so I removed it. 

################################################################################################


#Preparation

#dat <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roa))),]

`vectorfinal(7)`<-`vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roa))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.1))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.1.1))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.1.1))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$csho))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$roat.2))),]
`vectorfinal(7)` <- `vectorfinal(7)`[!is.na(as.numeric(as.character(`vectorfinal(7)`$shareturnover))),]


#dat1 <- transform( `vectorfinal(7)`[grep("^\\d+$",  `vectorfinal(7)`$roa),,drop=T], roa= as.numeric(as.character(roa)))
#dat1 <- transform( `vectorfinal(7)`[grep("^\\d+$",  `vectorfinal(7)`$roat.1),,drop=T], roat.1= as.numeric(as.character(roat.1)))
#dat1 <- transform( `vectorfinal(7)`[grep("^\\d+$",  `vectorfinal(7)`$roat.1.1),,drop=T], roat.1.1= as.numeric(as.character(roat.1.1)))

`vectorfinal(7)`$BOV=as.double(`vectorfinal(7)`$prcc)*as.double(`vectorfinal(7)`$csho) / as.double(`vectorfinal(7)`$ceq)
`vectorfinal(7)`$posl=as.double(`vectorfinal(7)`$posl)*100
`vectorfinal(7)`$negl=as.double(`vectorfinal(7)`$negl)*100
`vectorfinal(7)`$negneg=as.double(`vectorfinal(7)`$negneg)*100

`vectorfinal(7)`$gic=as.character(`vectorfinal(7)`$gic)
`vectorfinal(7)`$year=as.character(`vectorfinal(7)`$year)
#`vectorfinal(7)`$percwrds=(as.double(`vectorfinal(7)`$posl)+as.double(`vectorfinal(7)`$negneg))/ as.double(`vectorfinal(7)`$negl)
#`vectorfinal(7)`$percwrds=as.double(`vectorfinal(7)`$percwrds)

`vectorfinal(7)`$roac=as.numeric(`vectorfinal(7)`$roa)-as.numeric(`vectorfinal(7)`$roat.1) # year (t)- year (t-1) ROA 
`vectorfinal(7)`$roac1=as.numeric(`vectorfinal(7)`$roat.1.1)-as.numeric(`vectorfinal(7)`$roa) # year (t+1) - year (t) ROA
`vectorfinal(7)`$roacp=as.numeric(`vectorfinal(7)`$roat.1)-as.numeric(`vectorfinal(7)`$roat.2) # year (t-1) - year (t-2) ROA


#results <- fastDummies::dummy_cols(fastDummies_example, select_columns = "cik")

################################################################################################


# First, akin to LM, our data indeed suggests that a high positive:negative performance words percentage in disclosure is correlated with higher future performance (significant at 5 percent level)
# Using the ratio of positive to negative performance (percwrds)  


reg = lm_robust(as.double(roac) ~ as.double(percwrds)+log(as.double(BOV))+gic+year+log(as.double(shareturnover))+as.double(roacp), data = subset(`vectorfinal(7)`))
summary(reg)

reg = lm(as.double(roac) ~ as.double(percwrds)+log(as.double(BOV))+gic+year+log(as.double(shareturnover))+as.double(roacp), data = subset(`vectorfinal(7)`))
summary(reg)

#Clustered error by gic sector 

coeftest(reg, vcov=vcovHC(reg, type = 'HC0', cluster = 'gic'), data = subset(`vectorfinal(7)`))


#changes: adjusted period change date, removed log length 

"""

Call:
lm_robust(formula = as.double(roac) ~ as.double(percwrds) + log(as.double(BOV)) + 
gic + year + log(as.double(shareturnover)) + roacp, data = subset(`vectorfinal(7)`))

Standard error type:  HC2 

Coefficients:
Estimate Std. Error    t value  Pr(>|t|)   CI Lower   CI Upper    DF
(Intercept)                    2.259e+04  6.251e+03   3.613345 3.026e-04  1.034e+04  3.484e+04 42653
as.double(percwrds)            6.284e-02  1.697e-02   3.703697 2.127e-04  2.959e-02  9.610e-02 42653
log(as.double(BOV))            3.691e+01  3.923e+01   0.940871 3.468e-01 -3.998e+01  1.138e+02 42653
gic101010                     -3.347e+03  5.196e+03  -0.644181 5.195e-01 -1.353e+04  6.837e+03 42653
gic101020                     -2.604e+03  5.176e+03  -0.503127 6.149e-01 -1.275e+04  7.541e+03 42653
gic151010                     -2.795e+03  5.189e+03  -0.538742 5.901e-01 -1.297e+04  7.375e+03 42653
gic151020                     -1.385e+03  5.340e+03  -0.259409 7.953e-01 -1.185e+04  9.081e+03 42653
gic151030                     -2.611e+03  5.230e+03  -0.499203 6.176e-01 -1.286e+04  7.640e+03 42653
gic151040                     -3.122e+03  5.202e+03  -0.600156 5.484e-01 -1.332e+04  7.074e+03 42653
gic151050                     -2.104e+03  5.283e+03  -0.398290 6.904e-01 -1.246e+04  8.251e+03 42653
gic201010                     -2.683e+03  5.213e+03  -0.514617 6.068e-01 -1.290e+04  7.535e+03 42653
gic201020                     -2.125e+03  5.224e+03  -0.406767 6.842e-01 -1.236e+04  8.114e+03 42653
gic201030                     -2.514e+03  5.224e+03  -0.481233 6.304e-01 -1.275e+04  7.725e+03 42653
gic201040                     -2.358e+03  5.201e+03  -0.453468 6.502e-01 -1.255e+04  7.835e+03 42653
gic201050                     -2.327e+03  5.280e+03  -0.440798 6.594e-01 -1.268e+04  8.021e+03 42653
gic201060                     -2.696e+03  5.182e+03  -0.520251 6.029e-01 -1.285e+04  7.461e+03 42653
gic201070                     -2.267e+03  5.212e+03  -0.435067 6.635e-01 -1.248e+04  7.947e+03 42653
gic202010                     -3.331e+03  5.185e+03  -0.642432 5.206e-01 -1.349e+04  6.832e+03 42653
gic202020                     -3.104e+03  5.194e+03  -0.597568 5.501e-01 -1.328e+04  7.076e+03 42653
gic203010                     -3.537e+03  5.235e+03  -0.675619 4.993e-01 -1.380e+04  6.724e+03 42653
gic203020                     -1.795e+03  5.257e+03  -0.341430 7.328e-01 -1.210e+04  8.508e+03 42653
gic203030                     -2.753e+03  5.284e+03  -0.520927 6.024e-01 -1.311e+04  7.604e+03 42653
gic203040                     -2.006e+03  5.188e+03  -0.386676 6.990e-01 -1.218e+04  8.163e+03 42653
gic203050                     -3.255e+03  6.065e+03  -0.536688 5.915e-01 -1.514e+04  8.633e+03 42653
gic251010                     -3.111e+03  5.210e+03  -0.597118 5.504e-01 -1.332e+04  7.100e+03 42653
gic251020                     -6.014e+03  5.525e+03  -1.088665 2.763e-01 -1.684e+04  4.814e+03 42653
gic252010                     -3.498e+03  5.191e+03  -0.673954 5.003e-01 -1.367e+04  6.676e+03 42653
gic252020                     -1.934e+03  5.245e+03  -0.368638 7.124e-01 -1.221e+04  8.347e+03 42653
gic252030                     -3.968e+03  5.193e+03  -0.764016 4.449e-01 -1.415e+04  6.211e+03 42653
gic253010                     -2.756e+03  5.179e+03  -0.532240 5.946e-01 -1.291e+04  7.394e+03 42653
gic253020                     -3.103e+03  5.212e+03  -0.595340 5.516e-01 -1.332e+04  7.113e+03 42653
gic254010                     -3.424e+03  5.208e+03  -0.657532 5.108e-01 -1.363e+04  6.783e+03 42653
gic255010                     -2.707e+03  5.215e+03  -0.518980 6.038e-01 -1.293e+04  7.515e+03 42653
gic255020                     -2.475e+03  5.232e+03  -0.473042 6.362e-01 -1.273e+04  7.780e+03 42653
gic255030                     -2.188e+03  5.213e+03  -0.419748 6.747e-01 -1.241e+04  8.030e+03 42653
gic255040                     -3.097e+03  5.179e+03  -0.598054 5.498e-01 -1.325e+04  7.054e+03 42653
gic301010                     -2.436e+03  5.230e+03  -0.465684 6.414e-01 -1.269e+04  7.816e+03 42653
gic302010                     -2.400e+03  5.207e+03  -0.460862 6.449e-01 -1.261e+04  7.807e+03 42653
gic302020                     -3.035e+03  5.207e+03  -0.582808 5.600e-01 -1.324e+04  7.171e+03 42653
gic302030                     -3.809e+02  5.313e+03  -0.071695 9.428e-01 -1.079e+04  1.003e+04 42653
gic303010                     -2.137e+03  5.350e+03  -0.399365 6.896e-01 -1.262e+04  8.350e+03 42653
gic303020                     -3.953e+03  5.232e+03  -0.755496 4.500e-01 -1.421e+04  6.302e+03 42653
gic351010                     -2.210e+03  5.179e+03  -0.426743 6.696e-01 -1.236e+04  7.941e+03 42653
gic351020                     -2.743e+03  5.180e+03  -0.529595 5.964e-01 -1.289e+04  7.409e+03 42653
gic351030                     -1.541e+03  5.262e+03  -0.292816 7.697e-01 -1.185e+04  8.772e+03 42653
gic352010                     -1.328e+03  5.173e+03  -0.256693 7.974e-01 -1.147e+04  8.811e+03 42653
gic352020                     -2.082e+03  5.187e+03  -0.401349 6.882e-01 -1.225e+04  8.085e+03 42653
gic352030                     -1.957e+03  5.209e+03  -0.375701 7.071e-01 -1.217e+04  8.252e+03 42653
gic401010                     -2.297e+03  5.169e+03  -0.444254 6.569e-01 -1.243e+04  7.836e+03 42653
gic401020                     -2.385e+03  5.178e+03  -0.460574 6.451e-01 -1.253e+04  7.764e+03 42653
gic402010                     -2.212e+03  5.258e+03  -0.420646 6.740e-01 -1.252e+04  8.094e+03 42653
gic402020                     -3.136e+03  5.214e+03  -0.601444 5.475e-01 -1.335e+04  7.083e+03 42653
gic402030                     -2.439e+03  5.181e+03  -0.470772 6.378e-01 -1.259e+04  7.716e+03 42653
gic402040                     -2.853e+03  5.215e+03  -0.546962 5.844e-01 -1.307e+04  7.370e+03 42653
gic403010                     -2.636e+03  5.175e+03  -0.509373 6.105e-01 -1.278e+04  7.506e+03 42653
gic404010                     -2.384e+03  5.243e+03  -0.454680 6.493e-01 -1.266e+04  7.893e+03 42653
gic404020                     -2.812e+03  5.193e+03  -0.541557 5.881e-01 -1.299e+04  7.366e+03 42653
gic404030                     -2.486e+03  5.496e+03  -0.452363 6.510e-01 -1.326e+04  8.286e+03 42653
gic451010                     -1.552e+03  5.211e+03  -0.297826 7.658e-01 -1.177e+04  8.661e+03 42653
gic451020                     -2.144e+03  5.184e+03  -0.413540 6.792e-01 -1.231e+04  8.018e+03 42653
gic451030                     -2.568e+03  5.181e+03  -0.495781 6.201e-01 -1.272e+04  7.586e+03 42653
gic452010                     -4.013e+03  5.198e+03  -0.771903 4.402e-01 -1.420e+04  6.176e+03 42653
gic452020                     -3.078e+03  5.224e+03  -0.589293 5.557e-01 -1.332e+04  7.160e+03 42653
gic452030                     -2.847e+03  5.181e+03  -0.549597 5.826e-01 -1.300e+04  7.307e+03 42653
gic452040                      6.265e+03  6.163e+03   1.016559 3.094e-01 -5.814e+03  1.834e+04 42653
gic452050                     -8.034e+03  5.673e+03  -1.416197 1.567e-01 -1.915e+04  3.085e+03 42653
gic453010                     -3.378e+03  5.190e+03  -0.650794 5.152e-01 -1.355e+04  6.795e+03 42653
gic501010                     -2.892e+03  5.215e+03  -0.554488 5.792e-01 -1.311e+04  7.330e+03 42653
gic501020                     -1.501e+03  5.316e+03  -0.282420 7.776e-01 -1.192e+04  8.918e+03 42653
gic502010                     -1.152e+03  5.207e+03  -0.221345 8.248e-01 -1.136e+04  9.053e+03 42653
gic502020                     -1.376e+03  5.248e+03  -0.262308 7.931e-01 -1.166e+04  8.909e+03 42653
gic502030                     -1.800e+01  5.403e+03  -0.003332 9.973e-01 -1.061e+04  1.057e+04 42653
gic551010                     -2.474e+03  5.181e+03  -0.477468 6.330e-01 -1.263e+04  7.681e+03 42653
gic551020                     -1.917e+03  5.220e+03  -0.367241 7.134e-01 -1.215e+04  8.314e+03 42653
gic551030                     -2.348e+03  5.184e+03  -0.452892 6.506e-01 -1.251e+04  7.813e+03 42653
gic551040                     -2.637e+03  5.177e+03  -0.509278 6.106e-01 -1.278e+04  7.511e+03 42653
gic551050                     -1.075e+03  5.375e+03  -0.199999 8.415e-01 -1.161e+04  9.460e+03 42653
gic601010                     -1.954e+03  5.172e+03  -0.377731 7.056e-01 -1.209e+04  8.184e+03 42653
gic601020                     -3.064e+03  5.255e+03  -0.583082 5.598e-01 -1.336e+04  7.236e+03 42653
year1995                      -1.973e+04  3.563e+03  -5.537069 3.094e-08 -2.671e+04 -1.275e+04 42653
year1996                      -2.052e+04  3.481e+03  -5.894878 3.778e-09 -2.735e+04 -1.370e+04 42653
year1997                      -2.046e+04  3.474e+03  -5.888830 3.918e-09 -2.727e+04 -1.365e+04 42653
year1998                      -2.206e+04  3.474e+03  -6.348189 2.200e-10 -2.887e+04 -1.525e+04 42653
year1999                      -2.118e+04  3.477e+03  -6.090637 1.134e-09 -2.799e+04 -1.436e+04 42653
year2001                      -2.328e+04  3.473e+03  -6.701716 2.085e-11 -3.008e+04 -1.647e+04 42653
year2002                      -2.086e+04  3.479e+03  -5.997433 2.021e-09 -2.768e+04 -1.405e+04 42653
year2003                      -1.847e+04  3.470e+03  -5.323218 1.025e-07 -2.527e+04 -1.167e+04 42653
year2004                      -1.754e+04  3.470e+03  -5.054185 4.340e-07 -2.434e+04 -1.074e+04 42653
year2005                      -1.919e+04  3.470e+03  -5.529592 3.229e-08 -2.599e+04 -1.239e+04 42653
year2006                      -1.995e+04  3.470e+03  -5.749596 9.007e-09 -2.675e+04 -1.315e+04 42653
year2007                      -2.078e+04  3.471e+03  -5.987868 2.143e-09 -2.759e+04 -1.398e+04 42653
year2008                      -2.436e+04  3.472e+03  -7.013920 2.352e-12 -3.116e+04 -1.755e+04 42653
year2009                      -2.280e+04  3.471e+03  -6.567411 5.178e-11 -2.960e+04 -1.599e+04 42653
year2010                      -1.712e+04  3.471e+03  -4.931075 8.209e-07 -2.392e+04 -1.031e+04 42653
year2011                      -1.800e+04  3.469e+03  -5.187527 2.141e-07 -2.480e+04 -1.120e+04 42653
year2012                      -2.040e+04  3.468e+03  -5.880637 4.117e-09 -2.719e+04 -1.360e+04 42653
year2013                      -2.045e+04  3.468e+03  -5.895171 3.771e-09 -2.724e+04 -1.365e+04 42653
year2014                      -2.008e+04  3.468e+03  -5.789331 7.116e-09 -2.687e+04 -1.328e+04 42653
year2015                      -2.126e+04  3.468e+03  -6.128641 8.941e-10 -2.805e+04 -1.446e+04 42653
year2017                      -1.957e+04  3.469e+03  -5.642180 1.690e-08 -2.637e+04 -1.277e+04 42653
year2018                      -1.889e+04  3.470e+03  -5.443715 5.247e-08 -2.569e+04 -1.209e+04 42653
log(as.double(shareturnover)) -1.082e+02  3.524e+01  -3.070156 2.141e-03 -1.773e+02 -3.913e+01 42653
roacp                         -3.804e-01  5.710e-03 -66.609061 0.000e+00 -3.915e-01 -3.692e-01 42653

Multiple R-squared:  0.1587 ,	Adjusted R-squared:  0.1567 
F-statistic: 52.29 on 102 and 42653 DF,  p-value: < 2.2e-16






Call:
lm_robust(formula = as.double(roac1) ~ as.double(percwrds) + 
log(length) + log(as.double(BOV)) + gic + as.double(roac) + 
year, data = subset(`vectorfinal(7)`))

Standard error type:  HC2 

Coefficients:
Estimate Std. Error    t value  Pr(>|t|)   CI Lower   CI Upper    DF
(Intercept)         -4.602e+03  2.990e+03  -1.539286 1.237e-01 -1.046e+04  1.258e+03 46171
as.double(percwrds)  2.486e-02  1.418e-02   1.753405 7.954e-02 -2.930e-03  5.266e-02 46171
log(length)          4.547e+02  6.913e+01   6.578170 4.813e-11  3.192e+02  5.902e+02 46171
log(as.double(BOV))  5.268e+01  3.683e+01   1.430223 1.527e-01 -1.951e+01  1.249e+02 46171
gic101010           -2.347e+03  2.923e+03  -0.803126 4.219e-01 -8.076e+03  3.381e+03 46171
gic101020           -1.749e+03  2.895e+03  -0.604140 5.458e-01 -7.422e+03  3.925e+03 46171
gic151010           -8.041e+02  2.916e+03  -0.275755 7.827e-01 -6.519e+03  4.911e+03 46171
gic151020            6.881e+01  3.242e+03   0.021225 9.831e-01 -6.285e+03  6.423e+03 46171
gic151030           -2.829e+02  2.977e+03  -0.095041 9.243e-01 -6.118e+03  5.552e+03 46171
gic151040           -6.324e+02  2.931e+03  -0.215770 8.292e-01 -6.377e+03  5.112e+03 46171
gic151050           -6.451e+02  3.063e+03  -0.210633 8.332e-01 -6.648e+03  5.358e+03 46171
gic201010           -7.951e+02  2.948e+03  -0.269725 7.874e-01 -6.573e+03  4.982e+03 46171
gic201020           -2.596e+00  2.950e+03  -0.000880 9.993e-01 -5.785e+03  5.780e+03 46171
gic201030           -1.521e+03  2.970e+03  -0.512004 6.087e-01 -7.342e+03  4.301e+03 46171
gic201040           -2.992e+02  2.933e+03  -0.101993 9.188e-01 -6.048e+03  5.450e+03 46171
gic201050           -1.917e+03  3.062e+03  -0.626215 5.312e-01 -7.918e+03  4.084e+03 46171
gic201060           -1.144e+03  2.903e+03  -0.394239 6.934e-01 -6.834e+03  4.545e+03 46171
gic201070           -1.464e+03  2.940e+03  -0.498032 6.185e-01 -7.228e+03  4.299e+03 46171
gic202010           -7.553e+02  2.909e+03  -0.259663 7.951e-01 -6.456e+03  4.946e+03 46171
gic202020           -1.499e+03  2.923e+03  -0.512838 6.081e-01 -7.227e+03  4.229e+03 46171
gic203010           -2.323e+03  2.977e+03  -0.780220 4.353e-01 -8.159e+03  3.513e+03 46171
gic203020            1.699e+01  3.022e+03   0.005622 9.955e-01 -5.906e+03  5.940e+03 46171
gic203030           -1.626e+03  3.026e+03  -0.537304 5.911e-01 -7.557e+03  4.305e+03 46171
gic203040           -5.220e+02  2.915e+03  -0.179071 8.579e-01 -6.236e+03  5.192e+03 46171
gic203050           -3.698e+03  4.290e+03  -0.861962 3.887e-01 -1.211e+04  4.711e+03 46171
gic251010           -4.416e+02  2.959e+03  -0.149250 8.814e-01 -6.241e+03  5.358e+03 46171
gic251020           -1.210e+03  3.245e+03  -0.372799 7.093e-01 -7.569e+03  5.150e+03 46171
gic252010           -1.562e+03  2.916e+03  -0.535791 5.921e-01 -7.278e+03  4.153e+03 46171
gic252020           -5.559e+02  2.998e+03  -0.185422 8.529e-01 -6.432e+03  5.320e+03 46171
gic252030           -1.352e+03  2.915e+03  -0.463742 6.428e-01 -7.065e+03  4.361e+03 46171
gic253010           -6.955e+02  2.898e+03  -0.240029 8.103e-01 -6.375e+03  4.984e+03 46171
gic253020           -1.148e+03  2.956e+03  -0.388410 6.977e-01 -6.941e+03  4.645e+03 46171
gic254010           -2.949e+02  2.949e+03  -0.099995 9.203e-01 -6.074e+03  5.485e+03 46171
gic255010            3.227e+02  3.003e+03   0.107478 9.144e-01 -5.563e+03  6.208e+03 46171
gic255020           -1.195e+03  2.963e+03  -0.403346 6.867e-01 -7.002e+03  4.612e+03 46171
gic255030           -2.713e+03  2.982e+03  -0.909882 3.629e-01 -8.557e+03  3.131e+03 46171
gic255040           -1.438e+03  2.901e+03  -0.495821 6.200e-01 -7.124e+03  4.247e+03 46171
gic301010           -7.345e+02  2.954e+03  -0.248647 8.036e-01 -6.525e+03  5.056e+03 46171
gic302010           -6.017e+02  2.943e+03  -0.204451 8.380e-01 -6.370e+03  5.167e+03 46171
gic302020           -1.759e+03  2.944e+03  -0.597595 5.501e-01 -7.530e+03  4.011e+03 46171
gic302030           -2.023e+03  3.073e+03  -0.658237 5.104e-01 -8.046e+03  4.001e+03 46171
gic303010           -8.928e+02  3.274e+03  -0.272713 7.851e-01 -7.310e+03  5.524e+03 46171
gic303020           -1.830e+03  2.979e+03  -0.614151 5.391e-01 -7.669e+03  4.010e+03 46171
gic351010            2.564e+02  2.898e+03   0.088478 9.295e-01 -5.424e+03  5.937e+03 46171
gic351020           -8.926e+02  2.898e+03  -0.308013 7.581e-01 -6.573e+03  4.787e+03 46171
gic351030           -6.509e+02  3.006e+03  -0.216498 8.286e-01 -6.543e+03  5.242e+03 46171
gic352010            9.065e+02  2.889e+03   0.313766 7.537e-01 -4.756e+03  6.569e+03 46171
gic352020            3.624e+02  2.911e+03   0.124495 9.009e-01 -5.343e+03  6.068e+03 46171
gic352030           -3.309e+02  2.941e+03  -0.112487 9.104e-01 -6.096e+03  5.434e+03 46171
gic401010            8.725e+01  2.883e+03   0.030263 9.759e-01 -5.563e+03  5.738e+03 46171
gic401020           -1.134e+02  2.896e+03  -0.039173 9.688e-01 -5.789e+03  5.562e+03 46171
gic402010           -5.644e+01  3.024e+03  -0.018664 9.851e-01 -5.983e+03  5.870e+03 46171
gic402020           -2.606e+02  2.952e+03  -0.088275 9.297e-01 -6.048e+03  5.526e+03 46171
gic402030           -6.476e+02  2.903e+03  -0.223059 8.235e-01 -6.338e+03  5.043e+03 46171
gic402040           -1.395e+03  2.948e+03  -0.473234 6.360e-01 -7.173e+03  4.383e+03 46171
gic403010           -6.223e+02  2.892e+03  -0.215168 8.296e-01 -6.291e+03  5.046e+03 46171
gic404010            8.016e+02  2.970e+03   0.269918 7.872e-01 -5.019e+03  6.623e+03 46171
gic404020           -1.695e+02  2.924e+03  -0.057982 9.538e-01 -5.901e+03  5.561e+03 46171
gic404030           -9.883e+02  3.421e+03  -0.288884 7.727e-01 -7.694e+03  5.717e+03 46171
gic451010            3.815e+02  2.941e+03   0.129741 8.968e-01 -5.382e+03  6.145e+03 46171
gic451020           -6.575e+02  2.908e+03  -0.226141 8.211e-01 -6.356e+03  5.041e+03 46171
gic451030           -2.520e+02  2.900e+03  -0.086894 9.308e-01 -5.936e+03  5.432e+03 46171
gic452010           -1.568e+03  2.921e+03  -0.537016 5.913e-01 -7.293e+03  4.156e+03 46171
gic452020           -1.474e+03  2.969e+03  -0.496430 6.196e-01 -7.293e+03  4.345e+03 46171
gic452030           -8.799e+02  2.902e+03  -0.303253 7.617e-01 -6.567e+03  4.807e+03 46171
gic452040           -1.255e+04  1.326e+04  -0.946998 3.436e-01 -3.854e+04  1.343e+04 46171
gic452050           -5.553e+03  3.597e+03  -1.543770 1.227e-01 -1.260e+04  1.497e+03 46171
gic453010           -1.546e+02  2.916e+03  -0.053001 9.577e-01 -5.870e+03  5.561e+03 46171
gic501010           -8.578e+02  2.949e+03  -0.290875 7.711e-01 -6.638e+03  4.923e+03 46171
gic501020            1.208e+01  3.077e+03   0.003926 9.969e-01 -6.020e+03  6.044e+03 46171
gic502010            4.785e+02  2.940e+03   0.162757 8.707e-01 -5.284e+03  6.241e+03 46171
gic502020           -3.808e+01  3.021e+03  -0.012604 9.899e-01 -5.959e+03  5.883e+03 46171
gic502030            8.335e+02  3.122e+03   0.267008 7.895e-01 -5.285e+03  6.952e+03 46171
gic551010           -4.675e+02  2.902e+03  -0.161106 8.720e-01 -6.155e+03  5.220e+03 46171
gic551020           -1.039e+03  2.937e+03  -0.353814 7.235e-01 -6.797e+03  4.718e+03 46171
gic551030           -9.673e+02  2.906e+03  -0.332892 7.392e-01 -6.663e+03  4.728e+03 46171
gic551040           -6.145e+02  2.906e+03  -0.211498 8.325e-01 -6.310e+03  5.081e+03 46171
gic551050           -9.184e+02  3.160e+03  -0.290608 7.714e-01 -7.113e+03  5.276e+03 46171
gic601010            8.573e+01  2.889e+03   0.029674 9.763e-01 -5.577e+03  5.748e+03 46171
gic601020           -5.663e+02  3.015e+03  -0.187846 8.510e-01 -6.475e+03  5.343e+03 46171
as.double(roac)     -3.105e-01  5.127e-03 -60.570651 0.000e+00 -3.206e-01 -3.005e-01 46171
year1995            -1.668e+03  1.011e+03  -1.650853 9.878e-02 -3.649e+03  3.124e+02 46171
year1996            -1.328e+03  7.222e+02  -1.838634 6.598e-02 -2.743e+03  8.766e+01 46171
year1997            -3.513e+03  6.919e+02  -5.076924 3.851e-07 -4.869e+03 -2.157e+03 46171
year1998            -2.955e+03  6.937e+02  -4.259419 2.054e-05 -4.315e+03 -1.595e+03 46171
year1999            -2.211e+03  6.984e+02  -3.166451 1.544e-03 -3.580e+03 -8.425e+02 46171
year2001            -1.509e+03  6.847e+02  -2.203928 2.753e-02 -2.851e+03 -1.670e+02 46171
year2002            -4.698e+02  7.145e+02  -0.657554 5.108e-01 -1.870e+03  9.306e+02 46171
year2003             3.522e+02  6.824e+02   0.516181 6.057e-01 -9.853e+02  1.690e+03 46171
year2004            -1.340e+03  6.772e+02  -1.979152 4.780e-02 -2.668e+03 -1.296e+01 46171
year2005            -1.992e+03  6.834e+02  -2.915216 3.556e-03 -3.332e+03 -6.528e+02 46171
year2006            -3.133e+03  6.796e+02  -4.609759 4.042e-06 -4.465e+03 -1.801e+03 46171
year2007            -6.573e+03  6.935e+02  -9.478710 2.692e-21 -7.932e+03 -5.214e+03 46171
year2008            -4.422e+03  6.945e+02  -6.367705 1.937e-10 -5.784e+03 -3.061e+03 46171
year2009             6.976e+02  6.908e+02   1.009788 3.126e-01 -6.564e+02  2.052e+03 46171
year2010            -5.715e+02  6.845e+02  -0.834842 4.038e-01 -1.913e+03  7.702e+02 46171
year2011            -2.417e+03  6.798e+02  -3.554835 3.786e-04 -3.749e+03 -1.084e+03 46171
year2012            -2.520e+03  6.757e+02  -3.728762 1.927e-04 -3.844e+03 -1.195e+03 46171
year2013            -2.122e+03  6.768e+02  -3.135079 1.719e-03 -3.448e+03 -7.953e+02 46171
year2014            -3.322e+03  6.770e+02  -4.906566 9.300e-07 -4.649e+03 -1.995e+03 46171
year2015            -2.472e+03  6.736e+02  -3.669169 2.436e-04 -3.792e+03 -1.151e+03 46171
year2017            -1.270e+03  6.799e+02  -1.867289 6.187e-02 -2.602e+03  6.305e+01 46171
year2018            -2.915e+03  6.785e+02  -4.296347 1.740e-05 -4.245e+03 -1.585e+03 46171

Multiple R-squared:  0.1281 ,	Adjusted R-squared:  0.1262 
F-statistic: 44.51 on 102 and 46171 DF,  p-value: < 2.2e-16

"""


#However, based on our performance dictionary, we make additional observation that whilst it is indeed true that the disclosure of negative performance is
# correlated with negative performance. To study if companies disclose positive performance as it is, we divided positive performance into 
# negneg, whereby company discloses that it is trying to counteract negative performance (eg. reduce costs, reduce liabilities) and posl, whereby company simply tries 
# discusses positive performance (eg. increase in revenue). It is observed that company's description to counteract negative performance is correlated with performance improvement
# whereby the disclosure of existing positive performance is negatively correlated with performance improvement


reg = lm_robust(as.double(roac1) ~ as.double(posl)+ as.double(negl)+ as.double(negneg)+log(as.double(BOV))+gic+year+log(as.double(shareturnover))+as.double(roac), data = `vectorfinal(7)`)
summary(reg)


reg = lm(as.double(roac1) ~ as.double(posl)+ as.double(negl)+ as.double(negneg)+log(as.double(BOV))+gic+year+log(as.double(shareturnover))+as.double(roac), data = `vectorfinal(7)`)
summary(reg)

coeftest(reg, vcov=vcovHC(reg, type = 'HC0', cluster = 'gic'), data = subset(`vectorfinal(7)`))


"""


                                 Estimate  Std. Error  t value  Pr(>|t|)    
(Intercept)                   -8.2503e+03  1.4995e+04  -0.5502 0.5821839    
as.double(posl)               -1.2794e+03  3.6440e+02  -3.5111 0.0004468 ***
as.double(negl)               -1.4338e+02  7.5190e+01  -1.9068 0.0565470 .  
as.double(negneg)              2.4444e+03  3.5914e+02   6.8063 1.015e-11 ***
log(as.double(BOV))            5.0508e+01  3.7761e+01   1.3376 0.1810378    
gic101010                     -3.2992e+03  3.8010e+03  -0.8680 0.3854079    
gic101020                     -2.8672e+03  3.7788e+03  -0.7588 0.4479989    
gic151010                     -2.2036e+03  3.7943e+03  -0.5808 0.5614064    
gic151020                     -2.9216e+03  3.9621e+03  -0.7374 0.4608950    
gic151030                     -1.7989e+03  3.8373e+03  -0.4688 0.6392182    
gic151040                     -1.6420e+03  3.8072e+03  -0.4313 0.6662687    
gic151050                     -2.3118e+03  3.9044e+03  -0.5921 0.5537798    
gic201010                     -1.7532e+03  3.8216e+03  -0.4588 0.6464121    
gic201020                     -1.5180e+03  3.8217e+03  -0.3972 0.6912258    
gic201030                     -2.6918e+03  3.8396e+03  -0.7011 0.4832687    
gic201040                     -1.4817e+03  3.8084e+03  -0.3891 0.6972223    
gic201050                     -3.1519e+03  3.8987e+03  -0.8084 0.4188476    
gic201060                     -2.5886e+03  3.7852e+03  -0.6839 0.4940652    
gic201070                     -2.9877e+03  3.8135e+03  -0.7834 0.4333679    
gic202010                     -1.8194e+03  3.7898e+03  -0.4801 0.6311782    
gic202020                     -2.7557e+03  3.8007e+03  -0.7251 0.4684150    
gic203010                     -3.4682e+03  3.8452e+03  -0.9020 0.3670796    
gic203020                     -8.8839e+02  3.8793e+03  -0.2290 0.8188628    
gic203030                     -2.8880e+03  3.8940e+03  -0.7417 0.4582939    
gic203040                     -1.7678e+03  3.7931e+03  -0.4661 0.6411786    
gic203050                     -3.5885e+03  4.9624e+03  -0.7231 0.4695975    
gic251010                     -1.7933e+03  3.8280e+03  -0.4685 0.6394487    
gic251020                     -2.5227e+03  4.0948e+03  -0.6161 0.5378585    
gic252010                     -2.7562e+03  3.7948e+03  -0.7263 0.4676575    
gic252020                     -1.7288e+03  3.8550e+03  -0.4484 0.6538329    
gic252030                     -2.5073e+03  3.7934e+03  -0.6610 0.5086347    
gic253010                     -1.8339e+03  3.7814e+03  -0.4850 0.6276963    
gic253020                     -2.5045e+03  3.8293e+03  -0.6540 0.5130894    
gic254010                     -1.6507e+03  3.8225e+03  -0.4318 0.6658708    
gic255010                     -9.7738e+02  3.8504e+03  -0.2538 0.7996233    
gic255020                     -2.2839e+03  3.8383e+03  -0.5950 0.5518288    
gic255030                     -3.5828e+03  3.8435e+03  -0.9322 0.3512523    
gic255040                     -2.6158e+03  3.7834e+03  -0.6914 0.4893140    
gic301010                     -2.2517e+03  3.8290e+03  -0.5881 0.5564907    
gic302010                     -2.0040e+03  3.8111e+03  -0.5258 0.5990059    
gic302020                     -3.3355e+03  3.8181e+03  -0.8736 0.3823408    
gic302030                     -2.8742e+03  3.9253e+03  -0.7322 0.4640351    
gic303010                     -2.8809e+03  4.0299e+03  -0.7149 0.4746796    
gic303020                     -2.9764e+03  3.8390e+03  -0.7753 0.4381579    
gic351010                     -1.1124e+03  3.7818e+03  -0.2941 0.7686590    
gic351020                     -1.9458e+03  3.7809e+03  -0.5146 0.6068114    
gic351030                     -2.1246e+03  3.8721e+03  -0.5487 0.5832270    
gic352010                     -1.1347e+02  3.7744e+03  -0.0301 0.9760176    
gic352020                     -7.2706e+02  3.7926e+03  -0.1917 0.8479730    
gic352030                     -1.5134e+03  3.8154e+03  -0.3967 0.6916249    
gic401010                     -9.3214e+02  3.7706e+03  -0.2472 0.8047475    
gic401020                     -1.2057e+03  3.7803e+03  -0.3189 0.7497809    
gic402010                     -7.9328e+02  3.8907e+03  -0.2039 0.8384396    
gic402020                     -1.3117e+03  3.8264e+03  -0.3428 0.7317474    
gic402030                     -1.6802e+03  3.7851e+03  -0.4439 0.6571095    
gic402040                     -2.5913e+03  3.8221e+03  -0.6780 0.4977775    
gic403010                     -1.3681e+03  3.7763e+03  -0.3623 0.7171273    
gic404010                     -1.0234e+02  3.8510e+03  -0.0266 0.9787986    
gic404020                     -1.3367e+03  3.8033e+03  -0.3515 0.7252463    
gic404030                     -2.4105e+03  4.1699e+03  -0.5781 0.5632242    
gic451010                     -2.5681e+02  3.8223e+03  -0.0672 0.9464323    
gic451020                     -1.6765e+03  3.7888e+03  -0.4425 0.6581381    
gic451030                     -1.2852e+03  3.7823e+03  -0.3398 0.7340208    
gic452010                     -2.4139e+03  3.7996e+03  -0.6353 0.5252383    
gic452020                     -2.3596e+03  3.8372e+03  -0.6149 0.5386083    
gic452030                     -2.0670e+03  3.7827e+03  -0.5464 0.5847688    
gic452040                     -1.4285e+04  1.1022e+04  -1.2960 0.1949706    
gic452050                     -6.1935e+03  4.4881e+03  -1.3800 0.1676002    
gic453010                     -1.0773e+03  3.7957e+03  -0.2838 0.7765411    
gic501010                     -1.3469e+03  3.8263e+03  -0.3520 0.7248248    
gic501020                     -7.6316e+02  3.9568e+03  -0.1929 0.8470584    
gic502010                     -6.7203e+02  3.8142e+03  -0.1762 0.8601436    
gic502020                     -1.1169e+03  3.8868e+03  -0.2874 0.7738342    
gic502030                     -4.1524e+02  3.9915e+03  -0.1040 0.9171465    
gic551010                     -1.5859e+03  3.7844e+03  -0.4191 0.6751800    
gic551020                     -2.2577e+03  3.8043e+03  -0.5935 0.5528768    
gic551030                     -1.9602e+03  3.7861e+03  -0.5177 0.6046479    
gic551040                     -1.8378e+03  3.7865e+03  -0.4854 0.6274200    
gic551050                     -1.9817e+03  4.0088e+03  -0.4944 0.6210606    
gic601010                     -9.7361e+02  3.7738e+03  -0.2580 0.7964151    
gic601020                     -1.8935e+03  3.8761e+03  -0.4885 0.6251949    
year1995                       7.5990e+03  1.4522e+04   0.5233 0.6007947    
year1996                       8.3406e+03  1.4506e+04   0.5750 0.5653106    
year1997                       6.3859e+03  1.4505e+04   0.4403 0.6597530    
year1998                       7.0569e+03  1.4505e+04   0.4865 0.6265968    
year1999                       7.6401e+03  1.4505e+04   0.5267 0.5983987    
year2001                       8.4536e+03  1.4504e+04   0.5828 0.5600114    
year2002                       9.5758e+03  1.4505e+04   0.6602 0.5091594    
year2003                       1.0473e+04  1.4504e+04   0.7221 0.4702387    
year2004                       8.8795e+03  1.4503e+04   0.6122 0.5403850    
year2005                       8.5268e+03  1.4504e+04   0.5879 0.5566003    
year2006                       7.2504e+03  1.4504e+04   0.4999 0.6171514    
year2007                       3.8378e+03  1.4504e+04   0.2646 0.7913241    
year2008                       5.9178e+03  1.4505e+04   0.4080 0.6832762    
year2009                       1.1098e+04  1.4504e+04   0.7652 0.4441654    
year2010                       9.8219e+03  1.4503e+04   0.6772 0.4982758    
year2011                       7.9612e+03  1.4503e+04   0.5489 0.5830606    
year2012                       7.8980e+03  1.4503e+04   0.5446 0.5860522    
year2013                       8.3692e+03  1.4503e+04   0.5771 0.5639059    
year2014                       7.0556e+03  1.4503e+04   0.4865 0.6266287    
year2015                       7.8721e+03  1.4503e+04   0.5428 0.5872855    
year2017                       9.2580e+03  1.4504e+04   0.6383 0.5232660    
year2018                       7.5725e+03  1.4504e+04   0.5221 0.6015949    
log(as.double(shareturnover)) -9.7720e+01  3.2695e+01  -2.9888 0.0028020 ** 
as.double(roac)               -3.1329e-01  5.3123e-03 -58.9734 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
"""